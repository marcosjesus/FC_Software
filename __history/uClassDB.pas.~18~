unit uClassDB;

interface

uses uDados,  Messages,MensFun, System.DateUtils, Data.SqlTimSt,
  System.SysUtils, System.Classes, IniFiles,  Vcl.Forms, Vcl.Dialogs, uFunctions,
  FireDAC.Stan.Intf,
  FireDAC.Stan.Option, FireDAC.Stan.Param, FireDAC.Stan.Error, FireDAC.DatS,
  FireDAC.Phys.Intf, FireDAC.DApt.Intf, FireDAC.Stan.Async, FireDAC.DApt,
  FireDAC.Comp.DataSet, FireDAC.Comp.Client;


type
   TDBNextKey = class
     private
       FKey : integer;
       procedure setFKey(const Value : integer);
     protected

     public
       property Key : integer read FKey write setFKey;
       Constructor Create(varTableName : String);
   end;

implementation

{ TDBNextKey }



constructor TDBNextKey.Create(varTableName: String);
var
   DM :  TDados;
   SQL : TFDQuery;
begin

   DM  := TDados.Create(Nil);
   SQL := TFDQuery.Create(Nil);
   Try

     SQL.Connection := DM.FDConnection;
     SQL.Close;
     SQL.SQL.Clear;
     SQL.SQL.Add('Select Value + 1  From ' + varTableName );
     SQL.Open;

     Key := SQL.FieldByName('Value').AsInteger;

   Finally
     FreeAndNil(DM);
     FreeAndNil(SQL);
   End;
end;

procedure TDBNextKey.setFKey(const Value: integer);
begin
   FKey := value;
end;

end.
